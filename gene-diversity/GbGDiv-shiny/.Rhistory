theme(plot.title = element_text(face="bold"), axis.text.x = element_blank(), axis.title.x=element_text(vjust=-.5, size=14)) +
geom_vline(xintercept=mean(df$allelic.div), colour = "red", linetype="dashed") +
ylab("Density")  + xlab("Alleles per length in nucleotides") + guides(fill=FALSE)
ggplot(df, aes(x=allelic.div, fill="")) + geom_histogram(alpha=.7, binwidth=.01) +
ggtitle("Density of alleles per nucleotide position") +
theme(plot.title = element_text(face="bold"), axis.text.x = element_blank(), axis.title.x=element_text(vjust=-.5, size=14)) +
geom_vline(xintercept=mean(df$allelic.div), colour = "red", linetype="dashed") +
ylab("Density")  + xlab("Alleles per length in nucleotides") + guides(fill=FALSE)
ggplot(df) +
geom_point( data=subset(df, allelic.div.z < 1 | allelic.div.z > -1),aes(x=1, y=allelic.div.z), size=5, alpha=.5, position = position_jitter(w=0.5, h=0)) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$allelic.div.z), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci") +
xlab("")  + ylab("Alleles per nucleotide, by z-score") +
geom_text( data=subset(df, allelic.div.z > 6), aes(x=1, y=allelic.div.z, label=locus), size=4, alpha=.8, vjust=-1.5, position = position_jitter(width=0.5))
df$allelic.div.z <- scale(df$allelic.div, center = TRUE, scale = TRUE)
ggplot(df) +
geom_point( data=subset(df, allelic.div.z < 1 | allelic.div.z > -1),aes(x=1, y=allelic.div.z), size=5, alpha=.5, position = position_jitter(w=0.5, h=0)) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$allelic.div.z), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci") +
xlab("")  + ylab("Alleles per nucleotide, by z-score") +
geom_text( data=subset(df, allelic.div.z > 6), aes(x=1, y=allelic.div.z, label=locus), size=4, alpha=.8, vjust=-1.5, position = position_jitter(width=0.5))
ggplot(df) +
geom_boxplot(aes(x=category, y=allelic.div.z), alpha = 0, outlier.shape = " ") +
geom_point( data=subset(df, allelic.div.z < 1 | allelic.div.z > -1),aes(x=category, y=allelic.div.z), size=5, alpha=.5, position = position_jitter(w=0.15, h=0)) +
geom_point( data=subset(df, allelic.div.z > 1 | allelic.div.z < -1),aes(x=category, y=allelic.div.z), size=5, alpha=.5) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_text(size=14), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14)) +
geom_hline(yintercept=mean(df$allelic.div.z), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci, split by locus functional category") +
xlab("")  + ylab("Alleles per nucleotidee") +
geom_text( data=subset(df, allelic.div.z > 3), aes(x=category, y=allelic.div.z, label=locus), size=4, alpha=.8, vjust=-1.5, position = position_jitter(width=0.3))
ggplot(df) +
geom_boxplot(aes(x=category, y=allelic.div.z), alpha = 0, outlier.shape = " ") +
geom_point( data=subset(df, allelic.div.z < 1 | allelic.div.z > -1),aes(x=category, y=allelic.div.z), size=5, alpha=.5, position = position_jitter(w=0.15, h=0)) +
geom_point( data=subset(df, allelic.div.z > 1 | allelic.div.z < -1),aes(x=category, y=allelic.div.z), size=5, alpha=.5) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_text(size=14), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14)) +
geom_hline(yintercept=mean(df$allelic.div.z), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci, split by locus functional category") +
xlab("")  + ylab("Alleles per nucleotidee") +
geom_text( data=subset(df, allelic.div.z > 3), aes(x=category, y=allelic.div.z, label=locus), size=4, alpha=.8, vjust=1.5, position = position_jitter(width=0.3))
ggplot(df) +
geom_boxplot(aes(x=category, y=allelic.div.z), alpha = 0, outlier.shape = " ") +
geom_point( data=subset(df, allelic.div.z < 1 | allelic.div.z > -1),aes(x=category, y=allelic.div.z), size=5, alpha=.5, position = position_jitter(w=0.15, h=0)) +
geom_point( data=subset(df, allelic.div.z > 1 | allelic.div.z < -1),aes(x=category, y=allelic.div.z), size=5, alpha=.5) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_text(size=14), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14)) +
geom_hline(yintercept=mean(df$allelic.div.z), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci, split by locus functional category") +
xlab("")  + ylab("Alleles per nucleotidee") +
geom_text( data=subset(df, allelic.div.z > 2.5), aes(x=category, y=allelic.div.z, label=locus), size=4, alpha=.8, vjust=1.5, position = position_jitter(width=0.3))
ggplot(df) +
geom_boxplot(aes(x=category, y=allelic.div.z), alpha = 0, outlier.shape = " ") +
geom_point( data=subset(df, allelic.div.z < 1 | allelic.div.z > -1),aes(x=category, y=allelic.div.z), size=5, alpha=.5, position = position_jitter(w=0.15, h=0)) +
geom_point( data=subset(df, allelic.div.z > 1 | allelic.div.z < -1),aes(x=category, y=allelic.div.z), size=5, alpha=.5) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_text(size=14), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14)) +
geom_hline(yintercept=mean(df$allelic.div.z), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci, split by locus functional category") +
xlab("")  + ylab("Alleles per nucleotidee") +
geom_text( data=subset(df, allelic.div.z > 2.2), aes(x=category, y=allelic.div.z, label=locus), size=4, alpha=.8, vjust=1.5, position = position_jitter(width=0.3))
ggplot(df) +
geom_boxplot(aes(x=category, y=allelic.div.z), alpha = 0, outlier.shape = " ") +
geom_point( data=subset(df, allelic.div.z < 1 | allelic.div.z > -1),aes(x=category, y=allelic.div.z), size=5, alpha=.5, position = position_jitter(w=0.15, h=0)) +
geom_point( data=subset(df, allelic.div.z > 1 | allelic.div.z < -1),aes(x=category, y=allelic.div.z), size=5, alpha=.5) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_text(size=14), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14)) +
geom_hline(yintercept=mean(df$allelic.div.z), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci, split by locus functional category") +
xlab("")  + ylab("Alleles per nucleotidee") +
geom_text( data=subset(df, allelic.div.z > 2), aes(x=category, y=allelic.div.z, label=locus), size=4, alpha=.8, vjust=1.5, position = position_jitter(width=0.3))
ggplot(df) +
geom_boxplot(aes(x=category, y=allelic.div.z), alpha = 0, outlier.shape = " ") +
geom_point( data=subset(df, allelic.div.z < 1 | allelic.div.z > -1),aes(x=category, y=allelic.div.z), size=5, alpha=.5, position = position_jitter(w=0.15, h=0)) +
geom_point( data=subset(df, allelic.div.z > 1 | allelic.div.z < -1),aes(x=category, y=allelic.div.z), size=5, alpha=.5) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_text(size=14), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14)) +
geom_hline(yintercept=mean(df$allelic.div.z), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci, split by locus functional category") +
xlab("")  + ylab("Alleles per nucleotidee") +
geom_text( data=subset(df, allelic.div.z > 2.2), aes(x=category, y=allelic.div.z, label=locus), size=4, alpha=.8, vjust=1.5, position = position_jitter(width=0.3))
ggplot(df) +
geom_boxplot(aes(x=category, y=div.diff.z), alpha = 0, outlier.shape = " ") +
geom_point( data=subset(df, div.diff.z < 0.09 | div.diff.z > -0.03),aes(x=category, y=div.diff.z, colour=avg.length), size=5, alpha=.5, position = position_jitter(w=0.15, h=0)) +
geom_point( data=subset(df, div.diff.z > 0.09 | div.diff.z < -0.03),aes(x=category, y=div.diff.z, colour=avg.length), size=5, alpha=.5) +
coord_flip() + theme_minimal() + guides(fill=FALSE) +
theme(axis.text.y=element_text(size=14), plot.title = element_text(size="20", face="bold"), axis.title.x=element_text(vjust=-.5, size=14)) +
geom_hline(yintercept=mean(df$div.diff.z), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci, split by product function") +
xlab("")  + ylab("Difference in alleles/nucleotide from genome average, by standard deviation") +
geom_text( data=subset(df, div.diff.z > 3), aes(x=category, y=div.diff.z, label=locus), size=4, alpha=.8, vjust=1.5)
df$div.diff.z <- scale(df$div.diff, center = TRUE, scale = TRUE)
ggplot(df) +
geom_boxplot(aes(x=category, y=div.diff.z), alpha = 0, outlier.shape = " ") +
geom_point( data=subset(df, div.diff.z < 0.09 | div.diff.z > -0.03),aes(x=category, y=div.diff.z, colour=avg.length), size=5, alpha=.5, position = position_jitter(w=0.15, h=0)) +
geom_point( data=subset(df, div.diff.z > 0.09 | div.diff.z < -0.03),aes(x=category, y=div.diff.z, colour=avg.length), size=5, alpha=.5) +
coord_flip() + theme_minimal() + guides(fill=FALSE) +
theme(axis.text.y=element_text(size=14), plot.title = element_text(size="20", face="bold"), axis.title.x=element_text(vjust=-.5, size=14)) +
geom_hline(yintercept=mean(df$div.diff.z), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci, split by product function") +
xlab("")  + ylab("Difference in alleles/nucleotide from genome average, by standard deviation") +
geom_text( data=subset(df, div.diff.z > 3), aes(x=category, y=div.diff.z, label=locus), size=4, alpha=.8, vjust=1.5)
ggplot(df) +
geom_point( data=subset(df, div.diff.z < 0.09 | div.diff.z > -0.03),aes(x=category, y=div.diff.z), size=5, alpha=.5, position = position_jitter(w=0.15, h=0)) +
geom_point( data=subset(df, div.diff.z > 0.09 | div.diff.z < -0.03),aes(x=category, y=div.diff.z), size=5, alpha=.5) +
coord_flip() + theme_minimal() + guides(fill=FALSE) +
theme(axis.text.y=element_text(size=14), plot.title = element_text(size="20", face="bold"), axis.title.x=element_text(vjust=-.5, size=14)) +
geom_hline(yintercept=mean(df$div.diff.z), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci, split by product function") +
xlab("")  + ylab("Difference in alleles/nucleotide from genome average, by standard deviation") +
geom_text( data=subset(df, div.diff.z > 3), aes(x=category, y=div.diff.z, label=locus), size=4, alpha=.8, vjust=1.5)
ggplot(df) +
geom_point( data=subset(df, div.diff.z < 0.09 | div.diff.z > -0.03),aes(x=category, y=div.diff.z), size=5, alpha=.5, position = position_jitter(w=0.15, h=0)) +
geom_point( data=subset(df, div.diff.z > 0.09 | div.diff.z < -0.03),aes(x=category, y=div.diff.z), size=5, alpha=.5) +
coord_flip() + theme_minimal() + guides(fill=FALSE) +
theme(axis.text.y=element_text(size=14), plot.title = element_text(size="20", face="bold"), axis.title.x=element_text(vjust=-.5, size=14)) +
geom_hline(yintercept=mean(df$div.diff.z), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci, split by product function") +
xlab("")  + ylab("Difference in alleles/nucleotide from genome average, by standard deviation") +
geom_text( data=subset(df, div.diff.z > 2.2), aes(x=category, y=div.diff.z, label=locus), size=4, alpha=.8, vjust=1.5)
write.table(df,'/Users/user/Desktop/CHLAM-Feb.txt')
View(df.all)
View(df.all)
tail (df$div.diff)
tail ( sort(df$div.diff), 5 )
ggplot(df) +
geom_point( data=df , aes(x=x1, y=AllelicDiv), size=5, alpha=.5, label=df$Locus) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$AllelicDiv), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci") + xlab("")  + ylab("Alleles per nucleotide") +
geom_text(aes(x=x1, y=AllelicDiv, label=ifelse(AllelicDiv<quantile(AllelicDiv, .05) | AllelicDiv>quantile(AllelicDiv, .95),
as.character(Locus),'')), size=4, alpha=.8, vjust=-1.5)
library(ggplot2)
ggplot(df) +
geom_point( data=df , aes(x=x1, y=AllelicDiv), size=5, alpha=.5, label=df$Locus) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$AllelicDiv), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci") + xlab("")  + ylab("Alleles per nucleotide") +
geom_text(aes(x=x1, y=AllelicDiv, label=ifelse(AllelicDiv<quantile(AllelicDiv, .05) | AllelicDiv>quantile(AllelicDiv, .95),
as.character(Locus),'')), size=4, alpha=.8, vjust=-1.5)
ggplot(df) +
geom_point( data=df , aes(x=x1, y=ADivNM), size=5, alpha=.5, label=df$Locus) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$ADivNM), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci, compared to null model") + xlab("")  + ylab("Difference in alleles per nucleotide from genome average") +
geom_text(aes(x=x1, y=ADivNM, label=ifelse(ADivNM<quantile(ADivNM, .05) | ADivNM>quantile(ADivNM, .95),
as.character(Locus),'')), size=4, alpha=.8, vjust=-1.5)
df <- read.table.(file.choose(), header=TRUE, sep="\t")
df <- read.table(file.choose(), header=TRUE, sep="\t")
ggplot(df) +
geom_point( data=df , aes(x=x1, y=AllelicDiv), size=5, alpha=.5, label=df$Locus) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$AllelicDiv), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci") + xlab("")  + ylab("Alleles per nucleotide") +
geom_text(aes(x=x1, y=AllelicDiv, label=ifelse(AllelicDiv<quantile(AllelicDiv, .05) | AllelicDiv>quantile(AllelicDiv, .95),
as.character(Locus),'')), size=4, alpha=.8, vjust=-1.5)
x1 <- sample(seq(from = 0, to = 1, by = .01), size = nrow(df), replace = TRUE)
ggplot(df) +
geom_point( data=df , aes(x=x1, y=AllelicDiv), size=5, alpha=.5, label=df$Locus) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$AllelicDiv), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci") + xlab("")  + ylab("Alleles per nucleotide") +
geom_text(aes(x=x1, y=AllelicDiv, label=ifelse(AllelicDiv<quantile(AllelicDiv, .05) | AllelicDiv>quantile(AllelicDiv, .95),
as.character(Locus),'')), size=4, alpha=.8, vjust=-1.5)
tail ( sort(df$div.diff), 5 )
tail ( sort(df$DivDiff), 5 )
tail ( sort(df$ADivNM), 5 )
tail ( sort(df$ADivNM), 10 )
tail ( sort(df$ADivNM), 10 )[10]
tail ( sort(df$ADivNM), 10 )[1]
topcut    <- tail(sort(df$ADivNM), 10)[1]
top <- tail(sort(df$ADivNM), 10)[1]
top <- head(sort(df$ADivNM), 10)[1]
bot <- tail(sort(df$ADivNM), 10)[1]
head(sort(df$ADivNM), 10)
ggplot(df) +
geom_point( data=df , aes(x=x1, y=AllelicDiv), size=5, alpha=.5, label=df$Locus) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$AllelicDiv), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci") + xlab("")  + ylab("Alleles per nucleotide") +
geom_text(aes(x=x1, y=AllelicDiv, label=ifelse(AllelicDiv<head(sort(df$ADivNM), 10)[1] | AllelicDiv>tail(sort(df$ADivNM), 10)[1],
as.character(Locus),'')), size=4, alpha=.8, vjust=-1.5)
ggplot(df) +
geom_point( data=df , aes(x=x1, y=AllelicDiv), size=5, alpha=.5, label=df$Locus) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$AllelicDiv), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci") + xlab("")  + ylab("Alleles per nucleotide") +
geom_text(aes(x=x1, y=AllelicDiv, label=ifelse(AllelicDiv<head(sort(df$ADivNM), 10)[10] | AllelicDiv>tail(sort(df$ADivNM), 10)[1],
as.character(Locus),'')), size=4, alpha=.8, vjust=-1.5)
ggplot(df) +
geom_point( data=df , aes(x=x1, y=AllelicDiv), size=5, alpha=.5, label=df$Locus) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$AllelicDiv), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci") + xlab("")  + ylab("Alleles per nucleotide") +
geom_text(aes(x=x1, y=AllelicDiv, label=ifelse(AllelicDiv>tail(sort(df$ADivNM), 10)[1],
as.character(Locus),'')), size=4, alpha=.8, vjust=-1.5)
ggplot(df) +
geom_point( data=df , aes(x=x1, y=AllelicDiv), size=5, alpha=.5, label=df$Locus) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$AllelicDiv), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci") + xlab("")  + ylab("Alleles per nucleotide") +
geom_text(aes(x=x1, y=AllelicDiv, label=ifelse(AllelicDiv>head(sort(df$ADivNM), 10)[10] | AllelicDiv>tail(sort(df$ADivNM), 10)[1],
as.character(Locus),'')), size=4, alpha=.8, vjust=-1.5)
ggplot(df) +
geom_point( data=df , aes(x=x1, y=AllelicDiv), size=5, alpha=.5, label=df$Locus) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$AllelicDiv), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci") + xlab("")  + ylab("Alleles per nucleotide") +
geom_text(aes(x=x1, y=AllelicDiv, label=ifelse(AllelicDiv<head(sort(df$ADivNM), 10)[10] | AllelicDiv>tail(sort(df$ADivNM), 10)[1],
as.character(Locus),'')), size=4, alpha=.8, vjust=-1.5)
ggplot(df) +
geom_point( data=df , aes(x=x1, y=AllelicDiv), size=5, alpha=.5, label=df$Locus) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$AllelicDiv), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci") + xlab("")  + ylab("Alleles per nucleotide") +
geom_text(aes(x=x1, y=AllelicDiv, label=ifelse(AllelicDiv<head( 0.06 | AllelicDiv>tail(sort(df$ADivNM), 10)[1],
as.character(Locus),'')), size=4, alpha=.8, vjust=-1.5)
ggplot(df) +
geom_point( data=df , aes(x=x1, y=AllelicDiv), size=5, alpha=.5, label=df$Locus) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$AllelicDiv), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci") + xlab("")  + ylab("Alleles per nucleotide") +
geom_text(aes(x=x1, y=AllelicDiv, label=ifelse(AllelicDiv<head( 0.06 | AllelicDiv>tail(sort(df$ADivNM), 10)[1],
as.character(Locus),'')), size=4, alpha=.8, vjust=-1.5)
exit
ggplot(df) +
geom_point( data=df , aes(x=x1, y=AllelicDiv), size=5, alpha=.5, label=df$Locus) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$AllelicDiv), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci") + xlab("")  + ylab("Alleles per nucleotide") +
geom_text(aes(x=x1, y=AllelicDiv, label=ifelse(AllelicDiv< 0.06 | AllelicDiv>tail(sort(df$ADivNM), 10)[1],
as.character(Locus),'')), size=4, alpha=.8, vjust=-1.5)
ggplot(df) +
geom_point( data=df , aes(x=x1, y=AllelicDiv), size=5, alpha=.5, label=df$Locus) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$AllelicDiv), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci") + xlab("")  + ylab("Alleles per nucleotide") +
geom_text(aes(x=x1, y=AllelicDiv, label=ifelse(AllelicDiv< -0.06 | AllelicDiv>tail(sort(df$ADivNM), 10)[1],
as.character(Locus),'')), size=4, alpha=.8, vjust=-1.5)
ggplot(df) +
geom_point( data=df , aes(x=x1, y=AllelicDiv), size=5, alpha=.5, label=df$Locus) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$AllelicDiv), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci") + xlab("")  + ylab("Alleles per nucleotide") +
geom_text(aes(x=x1, y=AllelicDiv, label=ifelse(AllelicDiv< -0.05 | AllelicDiv>tail(sort(df$ADivNM), 10)[1],
as.character(Locus),'')), size=4, alpha=.8, vjust=-1.5)
head ( sort(df$ADivNM), 10)
ggplot(df) +
geom_point( data=df , aes(x=x1, y=ADivNM), size=5, alpha=.5, label=df$Locus) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$ADivNM), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci, compared to null model") + xlab("")  + ylab("Difference in alleles per nucleotide from genome average") +
geom_text(aes(x=x1, y=ADivNM, label=ifelse(ADivNM<quantile(ADivNM, .05) | ADivNM>quantile(ADivNM, .95),
as.character(Locus),'')), size=4, alpha=.8, vjust=-1.5)
ggplot(df) +
geom_point( data=df , aes(x=x1, y=ADivNM), size=5, alpha=.5, label=df$Locus) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$ADivNM), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci, compared to null model") + xlab("")  + ylab("Difference in alleles per nucleotide from genome average") +
geom_text(aes(x=x1, y=ADivNM, label=ifelse(ADivNM<head(sort(df$ADivNM),10)[10] | ADivNM>tail(sort(df$ADivNM),10)[10]
as.character(Locus),'')), size=4, alpha=.8, vjust=-1.5)
ggplot(df) +
geom_point( data=df , aes(x=x1, y=ADivNM), size=5, alpha=.5, label=df$Locus) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$ADivNM), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci, compared to null model") + xlab("")  + ylab("Difference in alleles per nucleotide from genome average") +
geom_text(aes(x=x1, y=ADivNM, label=ifelse(ADivNM<head(sort(df$ADivNM),10)[10] | ADivNM>tail(sort(df$ADivNM),10)[10],
as.character(Locus),'')), size=4, alpha=.8, vjust=-1.5)
ggplot(df) +
geom_point( data=df , aes(x=x1, y=ADivNM), size=5, alpha=.5, label=df$Locus) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$ADivNM), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci, compared to null model") + xlab("")  + ylab("Difference in alleles per nucleotide from genome average") +
geom_text(aes(x=x1, y=ADivNM, label=ifelse(ADivNM<head(sort(df$ADivNM),10)[10] | ADivNM>tail(sort(df$ADivNM),10)[1],
as.character(Locus),'')), size=4, alpha=.8, vjust=-1.5)
ggplot(df) +
geom_point( data=df , aes(x=x1, y=RatioVS), size=5, alpha=.5, label=df$Locus) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$RatioVS), size=1, colour="blue", linetype="dashed") +
ggtitle("Distribution of purifying to diversifying selection") + xlab("")  + ylab("Ratio of variable sites in nucleotide to amino acid format per locus") +
geom_text(aes(x=x1, y=RatioVS, label=ifelse(RatioVS<head(sort(df$RatioVS),10)[10] | RatioVS>tail(sort(df$RatioVS),10)[1],
as.character(Locus),'')), size=4, alpha=.8, vjust=-1.5)
ggplot(df) +
geom_point( data=df , aes(x=x1, y=RatioCount), size=5, alpha=.5, label=df$Locus) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$RatioCount), size=1, colour="blue", linetype="dashed") +
ggtitle("Distribution of purifying to diversifying selection") + xlab("")  + ylab("Ratio of unique nucleotide to unique amino acid sequences per locus") +
geom_text(aes(x=x1, y=RatioCount, label=ifelse(RatioCount<head(sort(df$RatioCount),10)[10] | RatioCount>tail(sort(df$RatioCount),10)[1],
as.character(Locus),'')), size=4, alpha=.8, vjust=-1.5)
ggplot(df) +
geom_point( data=df , aes(x=x1, y=ADivNM), size=5, alpha=.5, label=df$Locus) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$ADivNM), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci, compared to null model") + xlab("")  + ylab("Difference in alleles per nucleotide from genome average") +
geom_text(aes(x=x1, y=ADivNM, label=ifelse(ADivNM<head(sort(df$ADivNM),10)[10] | ADivNM>tail(sort(df$ADivNM),10)[1],
as.character(Locus),'')), size=4, alpha=.8, vjust=-1.5)
ggplot(df) +
geom_point( data=df , aes(x=x1, y=AllelicDiv), size=5, alpha=.5, label=df$Locus) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$AllelicDiv), size=1, colour="blue", linetype="dashed") +
ggtitle("Genetic diversity of loci") + xlab("")  + ylab("Alleles per nucleotide") +
geom_text(aes(x=x1, y=AllelicDiv, label=ifelse(AllelicDiv<head(sort(df$AllelicDiv),10)[10] | AllelicDiv>tail(sort(df$AllelicDiv),10)[1],
as.character(Locus),'')), size=4, alpha=.8, vjust=-1.5)
ggplot(df) +
geom_point( data=df , aes(x=x1, y=RatioVS), size=5, alpha=.5, label=df$Locus) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$RatioVS), size=1, colour="blue", linetype="dashed") +
ggtitle("Distribution of purifying to diversifying selection") + xlab("")  + ylab("Ratio of variable sites in nucleotide to amino acid format per locus") +
geom_text(aes(x=x1, y=RatioVS, label=ifelse(RatioVS<head(sort(df$RatioVS),10)[10] | RatioVS=>tail(sort(df$RatioVS),10)[1],
as.character(Locus),'')), size=4, alpha=.8, vjust=-1.5)
ggplot(df) +
geom_point( data=df , aes(x=x1, y=RatioVS), size=5, alpha=.5, label=df$Locus) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$RatioVS), size=1, colour="blue", linetype="dashed") +
ggtitle("Distribution of purifying to diversifying selection") + xlab("")  + ylab("Ratio of variable sites in nucleotide to amino acid format per locus") +
geom_text(aes(x=x1, y=RatioVS, label=ifelse(RatioVS<head(sort(df$RatioVS),10)[10] | RatioVS>=tail(sort(df$RatioVS),10)[1],
as.character(Locus),'')), size=4, alpha=.8, vjust=-1.5)
ggplot(df) +
geom_point( data=df , aes(x=x1, y=RatioCount), size=5, alpha=.5, label=df$Locus) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$RatioCount), size=1, colour="blue", linetype="dashed") +
ggtitle("Distribution of purifying to diversifying selection") + xlab("")  + ylab("Ratio of unique nucleotide to unique amino acid sequences per locus") +
geom_text(aes(x=x1, y=RatioCount, label=ifelse(RatioCount<head(sort(df$RatioCount),10)[10] | RatioCount>tail(sort(df$RatioCount),10)[1],
as.character(Locus),'')), size=4, alpha=.8, vjust=-1.5)
ggplot(df) +
geom_point( data=df , aes(x=x1, y=RatioCount), size=5, alpha=.5, label=df$Locus) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$RatioCount), size=1, colour="blue", linetype="dashed") +
ggtitle("Distribution of purifying to diversifying selection") + xlab("")  + ylab("Ratio of unique nucleotide to unique amino acid sequences per locus") +
geom_text(aes(x=x1, y=RatioCount, label=ifelse(RatioCount<head(sort(df$RatioCount),10)[10] | RatioCount>=tail(sort(df$RatioCount),10)[1],
as.character(Locus),'')), size=4, alpha=.8, vjust=-1.5)
ggplot(df) +
geom_point( data=df , aes(x=x1, y=RatioVS), size=5, alpha=.5, label=df$Locus) +
coord_flip() + theme_minimal() +
theme(axis.text.y=element_blank(), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14), axis.text.y = element_blank()) +
geom_hline(yintercept=mean(df$RatioVS), size=1, colour="blue", linetype="dashed") +
ggtitle("Distribution of purifying to diversifying selection") + xlab("")  + ylab("Ratio of variable sites in nucleotide to amino acid format per locus") +
geom_text(aes(x=x1, y=RatioVS, label=ifelse(RatioVS<head(sort(df$RatioVS),10)[10] | RatioVS>=tail(sort(df$RatioVS),10)[1],
as.character(Locus),'')), size=4, alpha=.8, vjust=-1.5)
View(df)
df <- read.table(file.choose(), header = TRUE, sep = "\t")
df$AllelicDiv <- c( df$CountNuc / df$AvgLength )
df$ADivNM <- c( (df$CountNuc - (mean(df$CountNuc / df$AvgLength) * df$AvgLength) ) / df$AvgLength )
df$VSitesNuc <- (df$AvgLength     - df$NonVarNuc) /  df$AvgLength
df$VSitesAA <- ((df$AvgLength / 3) - df$NonVarAA) / (df$AvgLength / 3)
df$RatioCount <- df$CountAA  /  df$CountNuc
df$RatioVS    <- df$VSitesAA /  df$VSitesNuc
ggplot(df, aes(x=Missing)) +
geom_histogram(binwidth=(nrow(df)/30)) +
geom_vline(xintercept=(9/10)*nrow(df),size=1, colour="red", linetype="dashed") +
theme_minimal() + scale_x_continuous(limits=c(0, nrow(df)),breaks=c((1:4*(1/4))*nrow(df)),labels=c("75%","50%","25%","00%")) +
theme(axis.text.y=element_text(size=14), axis.text.x=element_text(size=14), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14)) +
ggtitle("Distribution of loci by percentage of isolates where they have a known sequence") +
ylab("") + xlab("Percentage of isolates in which locus is known")
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
library("ggplot2", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
library(ggplot2)
df <- read.table(file.choose(), header = TRUE, sep = "\t")
df.all <- df
cutoff <- (9/10)*nrow(df.all) # excluding anything tagged in less than 10% of isolate records
df <- df[df$missing < cutoff,]
View(df.all)
View(df)
df <- df.all
df[df$missing < cutoff,]
df[df$missing < 3500,]
df[df$missing > 3500,]
df[df$Missing < 3500,]
cutoff <- (9/10)*nrow(df.all)
df <- df[df$Missing < cutoff,]
df.all[df.all$Missing < cutoff,]
df.all$Locus[df.all$Missing < cutoff,]
df.all[df.all$Missing > cutoff,]
df.all[df.all$Missing > cutoff,1]
length(df[df$Missing < cutoff,])
length(df.all[df.all$Missing < cutoff,])
length(df.all[df.all$Missing < cutoff,1])
length(df.all[df.all$Missing > cutoff,1])
removed <- length(df.all[df.all$Missing > cutoff,1])
print removed
print "Loci excluded due to being tagged in less than 10% of isolates:"
print ("Loci excluded due to being tagged in less than 10% of isolates:")
print (removed)
print ("Loci excluded due to being tagged in less than 10% of isolates:")
print (removed)
df <- read.table(file.choose(), header = TRUE, sep = "\t")
df$AllelicDiv <- c( df$CountNuc / df$AvgLength )
df$ADivNM <- c( (df$CountNuc - (mean(df$CountNuc / df$AvgLength) * df$AvgLength) ) / df$AvgLength )
df$VSitesNuc <- (df$AvgLength     - df$NonVarNuc) /  df$AvgLength
df$VSitesAA <- ((df$AvgLength / 3) - df$NonVarAA) / (df$AvgLength / 3)
df$RatioCount <- df$CountAA  /  df$CountNuc
df$RatioVS    <- df$VSitesAA /  df$VSitesNuc
ggplot(df, aes(x=Missing)) +
geom_histogram(binwidth=(nrow(df)/30)) +
geom_vline(xintercept=(9/10)*nrow(df),size=1, colour="red", linetype="dashed") +
theme_minimal() + scale_x_continuous(limits=c(0, nrow(df)),breaks=c((1:4*(1/4))*nrow(df)),labels=c("75%","50%","25%","00%")) +
theme(axis.text.y=element_text(size=14), axis.text.x=element_text(size=14), plot.title = element_text(face="bold"), axis.title.x=element_text(vjust=-.5, size=14)) +
ggtitle("Distribution of loci by percentage of isolates where they have a known sequence") +
ylab("") + xlab("Percentage of isolates in which locus is known")
df.all <- df
cutoff <- (9/10)*nrow(df.all) # excluding anything tagged in less than 10% of isolate records
df <- df[df$missing < cutoff,]
df <- df.all
cutoff <- (9/10)*nrow(df.all) # excluding anything tagged in less than 10% of isolate records
df <- df[df$missing > cutoff,]
df <- df.all
df <- df[df$missing > cutoff,]
df <- df.all
df <- df[df$missing < cutoff,]
df <- df.all
df <- df[df$Missing < cutoff,]
removed <- length(df.all[df.all$Missing > cutoff,1])
print ( paste ("Loci excluded due to being tagged in less than 10% of isolates:", removed) )
if (*exists*(a) {print("yes") } else { print("no") } )
if ( exists(a) {print("yes") } else { print("no") } )
if  exists(a) {print("yes") } else { print("no") }
exists(a)
exists(cutoff)
exists("cutoff")
exists("cutoffa")
help(if)
if exists(Args[2]) ( print("yes") ) else ( print("no") )
if exists(Args[2]) +
{ print("yes") }
else
{ print("no") }
install.packages("shiny")
library("shiny", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
})
runExample("01_hello")
library(shiny)
runExample("01_hello")
library(shiny)
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
qplot(df$AllelicDiv)
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")]
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/", display.mode = "showcase")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/", display.mode = "showcase")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/", display.mode = "showcase")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/", display.mode = "showcase")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/", display.mode = "showcase")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/", display.mode = "showcase")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/", display.mode = "showcase")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
runApp("/Volumes/sofia/big-batch/gene-diversity/GbGDiv-shiny/")
